\input{warning}

% Pass options to packages that might be loaded by style files
\PassOptionsToPackage{dvipsnames}{xcolor}
\PassOptionsToPackage{breaklinks,colorlinks}{hyperref}

% Load basic packages first
\usepackage{amsmath,amsopn,amsfonts}
\ifacmccs
\usepackage{epsfig,endnotes}
\else
\ifcolm
\usepackage{amssymb,mathtools,amsthm,lastpage,relsize}
\else
\usepackage{amssymb,mathtools,amsthm,fancyhdr,lastpage,times}
\fi
\fi

% Fonts
\usepackage{inconsolata}
\usepackage{newtxmath}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage{bm} % bold math

% Algorithms
\usepackage{algorithmic}
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}

\usepackage{latexsym}
\usepackage{subcaption}
\usepackage{endnotes,microtype,xspace,graphicx,fancyvrb,multirow}
\usepackage{booktabs}
\usepackage{array,underscore,relsize}
\usepackage[utf8]{inputenc}

\usepackage{pifont}
\usepackage[labelfont=bf,font=small,skip=5pt]{caption}

\usepackage[shortlabels]{enumitem}
\setlist[enumerate]{leftmargin=1cm,topsep=0.5mm}
\setlist[itemize]{leftmargin=0.5cm,topsep=0.5mm,noitemsep}
\setenumerate{label={\arabic*.},noitemsep,topsep=2pt,leftmargin=14pt}

% Set margin width for todonotes
\setlength{\marginparwidth}{2cm}
\usepackage[textsize=tiny]{todonotes}

% URL and links
\usepackage{url}
\usepackage{breakurl}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,      % section links, theorem refs, etc.
    citecolor=blue,      % citation links
    filecolor=blue,
    urlcolor=black        % url links
}
\usepackage[capitalise]{cleveref}
\crefformat{section}{\S#2#1#3}
\crefmultiformat{section}{\S\S#2#1#3}{ and~#2#1#3}{, #2#1#3}{, and~#2#1#3}


% Load natbib (conditionally)
\ifacmccs
% ACM CCS uses natbib by default, so we don't need to load it
\PassOptionsToPackage{numbers,sort&compress}{natbib}
\else\ifneurips
\PassOptionsToPackage{numbers,sort&compress}{natbib}
\else\ificml
\PassOptionsToPackage{numbers,sort&compress}{natbib}
\else\ificlr
\PassOptionsToPackage{numbers,sort&compress}{natbib}
\else
\PassOptionsToPackage{square,comma,numbers,sort&compress}{natbib}
\fi\fi\fi\fi

% Page style
\ifdefault
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\cfoot{\thepage}
\fi

% For math macro and numbers
\usepackage{fp}
\usepackage{siunitx}

% Balance bibliography
\usepackage{balance}

% Use \num{123456} -> 123,456
\sisetup{group-separator={,},group-minimum-digits={3},output-decimal-marker=.}

% Before loading hyperref, add:
% \makeatletter
% \def\@URL#1{\href{#1}{\nolinkurl{#1}}}
% \makeatother

\ifcolm
\ifcolmsubmission
\linenumbers
\fi

% Then your existing hyperref setup
\usepackage{lineno}

% Table related packages
\usepackage{tabularx}
\usepackage{makecell}
\usepackage{adjustbox}
\usepackage[normalem]{ulem}
\usepackage{tcolorbox}
\usepackage{colortbl}
\usepackage{listings}
\usepackage{wrapfig2}
\usepackage{setspace}
\usepackage{soul}
\usepackage{lipsum}
\usepackage{float}

% For native LaTeX plots
\usepackage{tikz}
\usetikzlibrary{patterns,calc,positioning,fit,shapes,matrix,arrows.meta,decorations.markings}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepgfplotslibrary{groupplots,units,fillbetween,statistics}
\pgfplotsset{compat=1.18}
